---
title: "Vaccine Tracker"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
    social: menu
    source_code: embed
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(shiny)
library(shinydashboard)
library(flexdashboard)
library(dplyr)
library(data.table)
library(plotly)
```

Inputs {.sidebar}
-----------------------------------------------------------------------
```{r, echo = F}
## R naught
## R = R_0^(generation)
sliderInput("R0", "R-Naught", min = 0, max = 20, value = 2, round = FALSE, step = .01)
sliderInput("gens", "n-Generations", min = 1, max = 10, round = TRUE, value = 4)
```


Row
-----------------------------------------------------------------------
```{r, echo = F}
## plotting
Theo_vals <- reactive({
  data.frame(Generation = seq(1, input$gens), NewInfected = input$R0^seq(1, input$gens))
  })
r_fig <- renderPlotly({
  plot_ly(Theo_vals(), x = ~Generation, y = ~NewInfected, type = "scatter", mode = "lines+markers")
})
r_fig

## Herd-Immunity
## 1 - s > 1 - 1/R_0
HIT_df <- data.frame(R0 = seq(1, 20), HIT = 1 - 1/R0)

## Herd-Immunity Threshold
HIT_fig <- renderPlotly({
  plot_ly(HIT_fig, x = ~R0, y = ~HIT, type = "scatter", mode = "lines+markers")
})
HIT_fig

```









